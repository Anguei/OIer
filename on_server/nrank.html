<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"/>
		<link href="http://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
		<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
		<link rel="stylesheet" href="style.css"/>
		<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
		<script src="chart.js"></script><script src="mychart.js"></script>
		
	</head>
	<body>
		<title>OierDb</title>
		<div id = "school_view" class = "win" style = "flex-flow: column;display:none;">
			<div>
				<h2 id = "sch_name">
				</h2>
				<button onclick = "document.getElementById('school_view').style = 'display:none'" class = "sqrbtn extbtn fa fa-mail-reply"></button>
				<div id = "sch_desc">
					
				</div>
				<hr/>
			</div>
			<div style = "text-align:center;" >
				<div class="btn-group" role="group" aria-label="..." id = "con-group">
				</div>
			</div>
			<br/>
			<div style = "flex: 1;border:2px solid #ffffff">
				<canvas id="canvas" style = "background:#ffffff"></canvas>
			</div>
		</div>
		
		<div id="container">
			<br/>
			<div  style = "text-align:center;">
				<a href = "index.html"><img src="logo.jpg" style = "width:40%;"/></a>
				<h2>全国信息学竞赛学校排名2018</h2>
				<hr/>
				<p>
				省份:
				<select id = "prov_select" onchange = "fetch_new(1)">
					<option value ="">任意</option>
					<option value ="湖南">湖南</option>
					<option value ="浙江">浙江</option>
					<option value ="福建">福建</option>
					<option value ="四川">四川</option>
					<option value ="广东">广东</option>
					<option value ="上海">上海</option>
					<option value ="江苏">江苏</option>
					<option value ="山东">山东</option>
					<option value ="河南">河南</option>
					<option value ="重庆">重庆</option>
					<option value ="河北">河北</option>
					<option value ="湖北">湖北</option>
					<option value ="安徽">安徽</option>
					<option value ="辽宁">辽宁</option>
					<option value ="北京">北京</option>
					<option value ="海南">海南</option>
					<option value ="山西">山西</option>
					<option value ="吉林">吉林</option>
					<option value ="黑龙江">黑龙江</option>
					<option value ="天津">天津</option>
					<option value ="广西">广西</option>
					<option value ="香港">香港</option>
					<option value ="江西">江西</option>
					<option value ="陕西">陕西</option>
					<option value ="新疆">新疆</option>
					<option value ="宁夏">宁夏</option>
					<option value ="内蒙古">内蒙古</option>
					<option value ="贵州">贵州</option>
					<option value ="长沙">长沙</option>
					<option value ="澳门">澳门</option>
					<option value ="甘肃">甘肃</option>
					<option value ="云南">云南</option>
				</select>
				地市:
				<select id = "city_select"  onchange = "fetch_new(1)">
					<option value ="">任意</option>
				</select>
				</p>
			</div>
			<div id = "dataArea" style = "display:;height:80ph">
				<table class="table">
					<thead>
						<tr>
							<th width = "10%">#</th>
							<th width = "60%">学校</th>
							<th width = "15%">排名</th>
							<th width = "15%">评分</th>
						</tr>
					</thead>
					<tr id = "load_svg" style = "display:none"><td colspan="4" style = "text-align:center"><img  src = "loading.svg" width = 45px/></td></tr>
					<tbody id = "resultArea" >
						
					</tbody>
				</table>
			</div>
			<div style = "text-align:center;" >
				<button type="button" class="btn minebtn"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span></button>
				<div class="btn-group" role="group" aria-label="..." id = "con-group">
					
				</div>
				<button type="button" class="btn minebtn"><span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></button>
			</div>
		</div>
		
		<script>
			function fetch_new(e){
				document.getElementById('load_svg').style = 'display:';
				document.getElementById('con-group').innerHTML = '';
				var XMLHttp=new XMLHttpRequest()
				XMLHttp.open("GET","http://bytew.net/OIer/rank.php?page="+e.toString()+"&province="+$("#prov_select").val()+"&city="+$("#city_select").val());
				XMLHttp.send();
				XMLHttp.onreadystatechange=function(){
					if (XMLHttp.readyState==4 && XMLHttp.status==200){
						if(XMLHttp.responseText!=""){
							document.getElementById('load_svg').style = 'display:none';
							document.getElementById('resultArea').innerHTML = '';
							var cc = eval("(" + XMLHttp.responseText + ")");
							for(var i in cc.result){
								var datas = cc.result[i];
								datas["name"] = eval(datas["name"]);
								document.getElementById('resultArea').innerHTML+='<tr style = "height:50px"><th>'+datas['id']+'</th><td>'+datas['name'][0]+'</td><td>'+datas['rank']+'</td><td>'+datas['rating']+'</td><tr>';
							}
						}
					}
				}
			}
		fetch_new(1);
			</script>
	</body>
	
</html>
